/*******************************************************************************
    GLUE-Math test routine: chisqcdf():

	Reference:
	  C-gengo ni yoru Hyoujun Algorithm Jiten - Haruhiko Okumura
	  ISBN978-4-7741-9690-9
******************************************************************************/
#include "../dist/dist.h"
#include <stdio.h>
#include <stdlib.h>
/*******************************************************************************
Compile on MinGW 64bit:
$ gcc -Wall -Wextra -O3 -o bin/chisqcdf test/chisqcdf.c dist/chisqcdf.c dist/chisqcdfc.c

And Test Result:
***** p_chi2(chi2, df) *****
chi2   df=1             df=2             df=5             df=20
 0.0 0.00000000000000 0.00000000000000 0.00000000000000 0.00000000000000
 0.5 0.52049987781305 0.22119921692860 0.00787670676737 0.00000000000021
 1.0 0.68268949213709 0.39346934028737 0.03743422675270 0.00000000017097
 1.5 0.77932863808015 0.52763344725899 0.08693018545560 0.00000000786336
 2.0 0.84270079294971 0.63212055882856 0.15085496391539 0.00000011142548
 2.5 0.88615370199334 0.71349520313981 0.22350492887668 0.00000082848749
 3.0 0.91673548333645 0.77686983985157 0.30001416412137 0.00000409750098
 3.5 0.93863117086060 0.82622605654955 0.37661237225042 0.00001529798356
 4.0 0.95449973610364 0.86466471676339 0.45058404864722 0.00004649807502
 4.5 0.96610514647531 0.89460077543814 0.52011656188670 0.00012080457757
 5.0 0.97465268132253 0.91791500137610 0.58411981300449 0.00027735209462
 5.5 0.98098352632770 0.93607213879329 0.64205411914904 0.00057622194673
 6.0 0.98569412156457 0.95021293163214 0.69378108158672 0.00110248813012
 6.5 0.98921255074533 0.96122579216828 0.73944154408925 0.00196865458919
 7.0 0.99184902840650 0.96980261657768 0.77935969206329 0.00331494426463
 7.5 0.99383010067946 0.97648225414399 0.81397016639713 0.00530717381933
 8.0 0.99532226501895 0.98168436111127 0.84376437242228 0.00813224279693
 8.5 0.99644853519229 0.98573576609100 0.86925221072557 0.01199153434243
 9.0 0.99730020393674 0.98889100346176 0.89093584205023 0.01709273289938
 9.5 0.99794528102387 0.99134830479688 0.90929260829595 0.02364069482096
***** q_chi2(chi2, df) *****
chi2   df=1             df=2             df=5             df=20
 0.0 1.00000000000000 1.00000000000000 1.00000000000000 1.00000000000000
 0.5 0.47950012218695 0.77880078307140 0.99212329323263 0.99999999999979
 1.0 0.31731050786291 0.60653065971263 0.96256577324730 0.99999999982903
 1.5 0.22067136191985 0.47236655274101 0.91306981454440 0.99999999213664
 2.0 0.15729920705029 0.36787944117144 0.84914503608461 0.99999988857452
 2.5 0.11384629800666 0.28650479686019 0.77649507112332 0.99999917151251
 3.0 0.08326451666355 0.22313016014843 0.69998583587863 0.99999590249902
 3.5 0.06136882913940 0.17377394345045 0.62338762774958 0.99998470201644
 4.0 0.04550026389636 0.13533528323661 0.54941595135278 0.99995350192498
 4.5 0.03389485352469 0.10539922456186 0.47988343811330 0.99987919542243
 5.0 0.02534731867747 0.08208499862390 0.41588018699551 0.99972264790538
 5.5 0.01901647367230 0.06392786120671 0.35794588085096 0.99942377805327
 6.0 0.01430587843543 0.04978706836786 0.30621891841328 0.99889751186988
 6.5 0.01078744925467 0.03877420783172 0.26055845591075 0.99803134541081
 7.0 0.00815097159350 0.03019738342232 0.22064030793671 0.99668505573537
 7.5 0.00616989932054 0.02351774585601 0.18602983360287 0.99469282618067
 8.0 0.00467773498105 0.01831563888873 0.15623562757772 0.99186775720307
 8.5 0.00355146480771 0.01426423390900 0.13074778927443 0.98800846565757
 9.0 0.00269979606326 0.01110899653824 0.10906415794977 0.98290726710062
 9.5 0.00205471897613 0.00865169520312 0.09070739170405 0.97635930517904
*******************************************************************************/

int
main(void)
{
	int i;
	double chi2;

	printf("***** p_chi2(chi2, df) *****\n");
	printf("chi2   %-16s %-16s %-16s %-16s\n",
	    "df=1", "df=2", "df=5", "df=20");
	for (i = 0; i < 20; i++) {
		chi2 = 0.5 * i;
		printf("%4.1f %16.14f %16.14f %16.14f %16.14f\n",
		    chi2, chisqcdf(chi2, 1), chisqcdf(chi2, 2),
		          chisqcdf(chi2, 5), chisqcdf(chi2, 20));
	}
	
	printf("***** q_chi2(chi2, df) *****\n");
	printf("chi2   %-16s %-16s %-16s %-16s\n",
	    "df=1", "df=2", "df=5", "df=20");
	for (i = 0; i < 20; i++) {
		chi2 = 0.5 * i;
		printf("%4.1f %16.14f %16.14f %16.14f %16.14f\n",
		    chi2, chisqcdfc(chi2, 1), chisqcdfc(chi2, 2),
		          chisqcdfc(chi2, 5), chisqcdfc(chi2, 20));
	}
	return 0;
}
