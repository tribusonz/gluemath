/*******************************************************************************
	GLUE-Math Library: Euler Gamma Function
	
	Author:
	  Takuya Ooura (Original Algorithm)
	  Hironobu Inatsuka aka tribusonz (C ABI modify)
	License:
	  GPL + X11(MIT)
	Reference:
	  Ooura's Mathematical Software Packages
*******************************************************************************/
#include "gamerf.h"

long double _Complex
cgammal(long double _Complex x)
{
	static const long double
	pi  = 3.1415926535897932384626433832795028842e+00,
	pv  = 1.7073384106072256336552635469768405988e+01,
	pr  = 9.6430280376084227593136665415665434890e-08,
	p0  = 1.4885966277379481312144836654780489977e-05,
	p1  = 9.8197319346551593835492039252950643250e-04,
	p2  = 3.6452833584596387259416230162968814334e-02,
	p3  = 8.4440218943313053279736838769169637475e-01,
	p4  = 1.2799395416392675659501629085367313130e+01,
	p5  = 1.2958416314697458304456172805819466959e+02,
	p6  = 8.7934757442085093139482632461747688925e+02,
	p7  = 3.9603132208822057375892166788749852003e+03,
	p8  = 1.1570567689267327614796506829853701257e+04,
	p9  = 2.1118371610821741632467257070275867771e+04,
	p10 = 2.2735240766521371105419781548988441852e+04,
	p11 = 1.3237220278612707484073165339915814580e+04,
	p12 = 3.6413985805433870475220843772414784920e+03,
	p13 = 3.7799827284494982250871944924580183350e+02,
	p14 = 9.7548265781613156543352803894655242645e+00,
	p15 = 2.4781878010146311991379531059279396603e-02,
	q1  = 9.9999999999999999999999999999999505954e-01,
	q2  = 2.0000000000000000000000000000054314870e+00,
	q3  = 2.9999999999999999999999999979818447021e+00,
	q4  = 4.0000000000000000000000003832010974513e+00,
	q5  = 4.9999999999999999999999549613824869296e+00,
	q6  = 6.0000000000000000000036828053823278869e+00,
	q7  = 6.9999999999999999997722128314314457093e+00,
	q8  = 8.0000000000000000114079473554600382027e+00,
	q9  = 8.9999999999999995074649343321072905406e+00,
	q10 = 1.0000000000000019570887665497626544354e+01,
	q11 = 1.0999999999999226781739409388855954774e+01,
	q12 = 1.2000000000033685360735653796874490304e+01,
	q13 = 1.2999999998107373865740824582565523337e+01,
	q14 = 1.4000000179833580993347884693337842721e+01,
	q15 = 1.4999950264715053014007976344403787119e+01;

	long double _Complex y, w = x;
	if (creall(x) < 0)  w = 1 - x;
	y = ((((((((((((((((p15 /
	    (w + q15) + p14) / (w + q14) + p13) /
	    (w + q13) + p12) / (w + q12) + p11) /
	    (w + q11) + p10) / (w + q10) + p9)  /
	    (w + q9)  + p8)  / (w + q8)  + p7)  /
	    (w + q7)  + p6)  / (w + q6)  + p5)  /
	    (w + q5)  + p4)  / (w + q4)  + p3)  /
	    (w + q3)  + p2)  / (w + q2)  + p1)  /
	    (w + q1)  + p0)  / w + pr) *
	    cexpl((w - 0.5L) * clogl(w + pv) - w);
	if (creall(x) < 0)  y = pi / (y * csinl(pi * x));
	return y;
}
