/*******************************************************************************
	GLUE-Math test routine: binomcdf()

	Reference:
		C-gengo ni yoru Hyoujun Algorithm Jiten - Haruhiko Okumura
			ISBN978-4-7741-9690-9
*******************************************************************************/
#include "../dist/dist.h"
#include <stdio.h>
#include <stdlib.h>
#include <float.h>
/*******************************************************************************
MinGW 64bit gcc build:
$ gcc -Wall -Wextra -O3 -o bin/binomcdf test/binomcdf.c dist/binomcdf.c dist/binomcdfc.c

And test result:
Binomial Distribution CDF
n, p? 50 0.5
-> number of trials: 50
-> percentile: 0.5
(x)  Bi(x; n, p)
  0  0.000000000000001  1.000000000000000
  1  0.000000000000045  0.999999999999999
  2  0.000000000001133  0.999999999999955
  3  0.000000000018542  0.999999999998867
  4  0.000000000223089  0.999999999981458
  5  0.000000002104926  0.999999999776911
  6  0.000000016218703  0.999999997895074
  7  0.000000104933871  0.999999983781297
  8  0.000000581777902  0.999999895066129
  9  0.000002807050047  0.999999418222098
 10  0.000011930665838  0.999997192949953
 11  0.000045107450536  0.999988069334162
 12  0.000152932000802  0.999954892549464
 13  0.000468111455426  0.999847067999198
 14  0.001301085728361  0.999531888544574
 15  0.003300223983405  0.998698914271639
 16  0.007673338916315  0.996699776016595
 17  0.016419568782134  0.992326661083685
 18  0.032454323536136  0.983580431217866
 19  0.059460226279717  0.967545676463864
 20  0.101319375532269  0.940539773720283
 21  0.161118160178769  0.898680624467731
 22  0.239943830849159  0.838881839821231
 23  0.335905516882679  0.760056169150841
 24  0.443862413670389  0.664094483117321
 25  0.556137586329611  0.556137586329611
 26  0.664094483117321  0.443862413670389
 27  0.760056169150841  0.335905516882679
 28  0.838881839821231  0.239943830849159
 29  0.898680624467731  0.161118160178769
 30  0.940539773720283  0.101319375532269
 31  0.967545676463864  0.059460226279717
 32  0.983580431217866  0.032454323536136
 33  0.992326661083685  0.016419568782134
 34  0.996699776016595  0.007673338916315
 35  0.998698914271639  0.003300223983405
 36  0.999531888544574  0.001301085728361
 37  0.999847067999198  0.000468111455426
 38  0.999954892549464  0.000152932000802
 39  0.999988069334162  0.000045107450536
 40  0.999997192949953  0.000011930665838
 41  0.999999418222098  0.000002807050047
 42  0.999999895066129  0.000000581777902
 43  0.999999983781297  0.000000104933871
 44  0.999999997895074  0.000000016218703
 45  0.999999999776911  0.000000002104926
 46  0.999999999981458  0.000000000223089
 47  0.999999999998867  0.000000000018542
 48  0.999999999999955  0.000000000001133
 49  0.999999999999999  0.000000000000045
 50  1.000000000000000  0.000000000000000
*******************************************************************************/
int
main(void)
{
	int n;
	double p;

	puts("Binomial Distribution CDF");
	printf("n, p? ");  scanf("%d%lf", &n, &p);
	printf("-> number of trials: %d\n-> percentile: %g\n", n, p);
	puts("(x)  Bi(x; n, p)");
	for(volatile int x = 0; x <= n; x++)
	{
		printf("% 3d  %.*f  %.*f\n", 
		       x, DBL_DIG, binomcdf(x, n, p),
		          DBL_DIG, binomcdfc(x, n, p));
	}
	return 0;
}
