/*******************************************************************************
	GLUE-Math test suite: Euler Beta Function
*******************************************************************************/
#include "../realmath/realmath.h"
#include <stdio.h>
#include <stdlib.h>
#include <float.h>
/*******************************************************************************
MinGW 64bit gcc build:
$ gcc -Wall -Wextra -O3 -o bin/beta test/beta.c realmath/beta_r8.c

And test result:
GLUE-Math with POSIX standard
Test Suite:
  Euler Beta Function

 (b)       beta(1, b)       beta(3, b)       beta(5, b)       beta(8, b)
-5.0             -0.2  -0.033333333333             -0.2             -inf
-4.8  -0.208333333333  -0.039160401002  -0.326336675020  -129.7929957469
-4.6  -0.217391304347  -0.046451133407  -0.580639167595  -90.72486993682
-4.4  -0.227272727272  -0.055704099821  -1.193659281894  -100.4280645824
-4.2  -0.238095238095  -0.067640692640  -3.382034632034  -176.1476370851
-4.0            -0.25  -0.083333333333             -inf              inf
-3.8  -0.263157894736  -0.104427736006   7.832080200501   194.6894936204
-3.6  -0.277777777777  -0.133547008547   6.677350427350   122.7454122674
-3.4  -0.294117647058  -0.175070028011   8.753501400560   122.7454122674
-3.2          -0.3125  -0.236742424242   17.75568181818   194.6894936204
-3.0  -0.333333333333  -0.333333333333             -inf             -inf
-2.8  -0.357142857142  -0.496031746031  -24.80158730158  -176.1476370851
-2.6  -0.384615384615  -0.801282051282  -17.17032967032  -100.4280645824
-2.4  -0.416666666666  -1.488095238095  -18.60119047619  -90.72486993682
-2.2  -0.454545454545  -3.787878787878  -31.56565656565  -129.7929957469
-2.0             -0.5             -inf              inf              inf
-1.8  -0.555555555555   6.944444444444   31.56565656565   94.84872766122
-1.6           -0.625   5.208333333333   18.60119047619   48.35425331748
-1.4  -0.714285714285   5.952380952380   17.17032967032   38.88208711578
-1.2  -0.833333333333   10.41666666666   24.80158730158   49.23182597297
-1.0               -1             -inf             -inf             -inf
-0.8            -1.25  -10.41666666666  -17.75568181818  -27.53672738551
-0.6  -1.666666666666  -5.952380952380  -8.753501400560  -12.08856332937
-0.4             -2.5  -5.208333333333  -6.677350427350  -8.247715448802
-0.2               -5  -6.944444444444  -7.832080200501  -8.687969289349
 0.0              inf              inf              inf              inf
 0.2                5   3.787878787878   3.382034632034   3.059636376168
 0.4              2.5   1.488095238095   1.193659281894   0.980153783462
 0.6   1.666666666666   0.801282051282   0.580639167595   0.434090286779
 0.8             1.25   0.496031746031   0.326336675020   0.222768443316
 1.0                1   0.333333333333              0.2            0.125
 1.2   0.833333333333   0.236742424242   0.130078255078   0.074625277467
 1.4   0.714285714285   0.175070028011   0.088419206066   0.046673989688
 1.6            0.625   0.133547008547   0.062211339385   0.030285368845
 1.8   0.555555555555   0.104427736006   0.045011955175   0.020251676665
 2.0              0.5   0.083333333333   0.033333333333   0.013888888888
 2.2   0.454545454545   0.067640692640   0.025176436466   0.009733731843
 2.4   0.416666666666   0.055704099821   0.019341701326   0.006951445272
 2.6   0.384615384615   0.046451133407   0.015081536820   0.005047561474
 2.8   0.357142857142   0.039160401002   0.011914929311   0.003719695714
 3.0   0.333333333333   0.033333333333   0.009523809523   0.002777777777
 3.2           0.3125   0.028617216117   0.007692800031   0.002099432358
 3.4   0.294117647058   0.024757377698   0.006272984214   0.001604179678
 3.6   0.277777777777   0.021566597653   0.005159473122   0.001238081116
 3.8   0.263157894736   0.018905021173   0.004277154111   0.000964365555
 4.0             0.25   0.016666666666   0.003571428571   0.000757575757
 4.2   0.238095238095   0.014770176060   0.003002068304   0.000599837816
 4.4   0.227272727272   0.013152356902   0.002539065039   0.000478439553
 4.6   0.217391304347   0.011763598720   0.002159779446   0.000384232070
 4.8   0.208333333333   0.010564570655   0.001846952911   0.000310558399
 5.0              0.2   0.009523809523   0.001587301587   0.000252525252
*******************************************************************************/

static char *beta_print_dbl(double a, double b);

int
main(void)
{
	puts("GLUE-Math with POSIX standard");
	puts("Test Suite:");
	puts("  Euler Beta Function");
	puts("");

	puts(" (b)       beta(1, b)       beta(3, b)       beta(5, b)       beta(8, b)");
	for (volatile int i = -50; i <= 50; i += 2)
	{
		const double b = i / 10.0;
		printf("% 1.1f  ", b);
		printf("%*.*s  ", DBL_DIG, DBL_DIG, beta_print_dbl(1, b));
		printf("%*.*s  ", DBL_DIG, DBL_DIG, beta_print_dbl(3, b));
		printf("%*.*s  ", DBL_DIG, DBL_DIG, beta_print_dbl(5, b));
		printf("%*.*s  ", DBL_DIG, DBL_DIG, beta_print_dbl(8, b));
		puts("");
	}
	
	return 0;
}

static char *
beta_print_dbl(double a, double b)
{
	static char s[0x200];
	
	snprintf(s, 0x200, "% *.*g", DBL_DIG, DBL_DIG, beta_r8(a, b));

	return s;
}
