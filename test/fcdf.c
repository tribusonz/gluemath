/*******************************************************************************
    GLUE-Math test routine: fcdf() Integer df

	Reference:
	  C-gengo ni yoru Hyoujun Algorithm Jiten - Haruhiko Okumura
	  ISBN978-4-7741-9690-9
*******************************************************************************/
#include "../dist/dist.h"
#include <stdio.h>
#include <stdlib.h>
/*******************************************************************************
MinGW 64bit gcc build:
$ gcc -Wall -Wextra -O3 -o bin/fcdf test/fcdf.c dist/fcdf.c dist/fcdfc.c

And test result:
lower
***** p_f(f, 1, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 0.00000000000000 0.00000000000000 0.00000000000000 0.00000000000000
   1 0.50000000000000 0.57735026918963 0.63678253235088 0.67074342282829
   2 0.60817344796939 0.70710678118655 0.78356277073031 0.82732169601283
   3 0.66666666666667 0.77459666924148 0.85618919128840 0.90133955345109
   4 0.70483276469913 0.81649658092773 0.89806052117014 0.94073446455343
   5 0.73227952719877 0.84515425472852 0.92441318157839 0.96309515706582
   6 0.75324828557115 0.86602540378444 0.94202722644246 0.97635715208983
   7 0.76994654383738 0.88191710368820 0.95434087621859 0.98449097601989
   8 0.78365310406121 0.89442719099992 0.96325740199485 0.98961752294973
   9 0.79516723530087 0.90453403373329 0.96990075210254 0.99292410120879
  10 0.80501777095786 0.91287092917528 0.97496898418155 0.99510002315045
***** p_f(f, 2, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 0.00000000000000 0.00000000000000 0.00000000000000 0.00000000000000
   1 0.42264973081037 0.50000000000000 0.56879884962831 0.61445671057047
   2 0.55278640450004 0.66666666666667 0.76995185416669 0.83849441711015
   3 0.62203552699077 0.75000000000000 0.86070250775553 0.92746184971359
   4 0.66666666666667 0.80000000000000 0.90825833240443 0.96542838696639
   5 0.69848865542224 0.83333333333333 0.93584997009004 0.98265847008417
   6 0.72264990188739 0.85714285714286 0.95308597365513 0.99090505298227
   7 0.74180111025284 0.87500000000000 0.96447443379207 0.99503966753184
   8 0.75746437496367 0.88888888888889 0.97233843330645 0.99719924610274
   9 0.77058426612944 0.90000000000000 0.97796538732892 0.99836896233387
  10 0.78178210976401 0.90909090909091 0.98211145618000 0.99902343750000
***** p_f(f, 5, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 0.00000000000000 0.00000000000000 0.00000000000000 0.00000000000000
   1 0.36321746764912 0.43120115037169 0.50000000000000 0.55697481531512
   2 0.51108408043028 0.63393814526061 0.76748868086962 0.87749275531816
   3 0.58872444808968 0.73131729495238 0.87341500244984 0.96479866254733
   4 0.63829887164093 0.78798561094677 0.92281137475779 0.98881624814473
   5 0.67342843553755 0.82497466447992 0.94903026058507 0.99606958007561
   6 0.69998654277887 0.85099731728190 0.96432821926623 0.99848845892582
   7 0.72097120207323 0.87029362185545 0.97390929977147 0.99937140004485
   8 0.73809260189391 0.88517013419368 0.98024709516233 0.99972030361511
   9 0.75240657529366 0.89698801353546 0.98462527955746 0.99986803900762
  10 0.76460477678879 0.90660195607518 0.98775808346893 0.99993447816858
***** p_f(f, 20, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 0.00000000000000 0.00000000000000 0.00000000000000 0.00000000000000
   1 0.32925657717171 0.38554328942953 0.44302518468488 0.50000000000000
   2 0.48765809505138 0.61391325354076 0.77260438579051 0.93523382720904
   3 0.57014583217285 0.72043633605563 0.88676949173034 0.99109672069608
   4 0.62253184228102 0.78119840172573 0.93488032449343 0.99842087945083
   5 0.65952651320327 0.82034829987516 0.95871164150958 0.99964823835344
   6 0.68742909755053 0.84764529108513 0.97194878157714 0.99990583534070
   7 0.70943865378849 0.86775457680384 0.97994100993659 0.99997079839697
   8 0.72737319795633 0.88318092615397 0.98508046021081 0.99998979902692
   9 0.74235190840519 0.89538779695361 0.98855200236122 0.99999607011767
  10 0.75510627752307 0.90528695469298 0.99099112625722 0.99999835726114
upper
***** q_f(f, 1, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 1.00000000000000 1.00000000000000 1.00000000000000 1.00000000000000
   1 0.50000000000000 0.42264973081037 0.36321746764912 0.32925657717171
   2 0.39182655203061 0.29289321881345 0.21643722926969 0.17267830398717
   3 0.33333333333333 0.22540333075852 0.14381080871160 0.09866044654891
   4 0.29516723530087 0.18350341907227 0.10193947882986 0.05926553544657
   5 0.26772047280123 0.15484574527148 0.07558681842161 0.03690484293418
   6 0.24675171442885 0.13397459621556 0.05797277355754 0.02364284791017
   7 0.23005345616262 0.11808289631180 0.04565912378141 0.01550902398011
   8 0.21634689593879 0.10557280900008 0.03674259800515 0.01038247705027
   9 0.20483276469913 0.09546596626671 0.03009924789746 0.00707589879121
  10 0.19498222904214 0.08712907082472 0.02503101581845 0.00489997684955
***** q_f(f, 2, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 1.00000000000000 1.00000000000000 1.00000000000000 1.00000000000000
   1 0.57735026918963 0.50000000000000 0.43120115037169 0.38554328942953
   2 0.44721359549996 0.33333333333333 0.23004814583331 0.16150558288985
   3 0.37796447300923 0.25000000000000 0.13929749224447 0.07253815028641
   4 0.33333333333333 0.20000000000000 0.09174166759557 0.03457161303361
   5 0.30151134457776 0.16666666666667 0.06415002990996 0.01734152991583
   6 0.27735009811261 0.14285714285714 0.04691402634487 0.00909494701773
   7 0.25819888974716 0.12500000000000 0.03552556620793 0.00496033246816
   8 0.24253562503633 0.11111111111111 0.02766156669355 0.00280075389726
   9 0.22941573387056 0.10000000000000 0.02203461267108 0.00163103766613
  10 0.21821789023599 0.09090909090909 0.01788854382000 0.00097656250000
***** q_f(f, 5, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 1.00000000000000 1.00000000000000 1.00000000000000 1.00000000000000
   1 0.63678253235088 0.56879884962831 0.50000000000000 0.44302518468488
   2 0.48891591956972 0.36606185473939 0.23251131913038 0.12250724468184
   3 0.41127555191032 0.26868270504762 0.12658499755016 0.03520133745267
   4 0.36170112835907 0.21201438905323 0.07718862524221 0.01118375185527
   5 0.32657156446245 0.17502533552008 0.05096973941493 0.00393041992439
   6 0.30001345722113 0.14900268271810 0.03567178073377 0.00151154107418
   7 0.27902879792677 0.12970637814455 0.02609070022853 0.00062859995515
   8 0.26190739810609 0.11482986580632 0.01975290483767 0.00027969638489
   9 0.24759342470634 0.10301198646454 0.01537472044254 0.00013196099238
  10 0.23539522321121 0.09339804392482 0.01224191653107 0.00006552183142
***** q_f(f, 20, df2) *****
  F   df2=1            df2=2            df2=5            df2=20
   0 1.00000000000000 1.00000000000000 1.00000000000000 1.00000000000000
   1 0.67074342282829 0.61445671057047 0.55697481531512 0.50000000000000
   2 0.51234190494862 0.38608674645924 0.22739561420949 0.06476617279096
   3 0.42985416782715 0.27956366394437 0.11323050826966 0.00890327930392
   4 0.37746815771898 0.21880159827427 0.06511967550657 0.00157912054917
   5 0.34047348679673 0.17965170012484 0.04128835849042 0.00035176164656
   6 0.31257090244947 0.15235470891487 0.02805121842286 0.00009416465930
   7 0.29056134621151 0.13224542319616 0.02005899006341 0.00002920160303
   8 0.27262680204367 0.11681907384603 0.01491953978919 0.00001020097308
   9 0.25764809159481 0.10461220304639 0.01144799763878 0.00000392988233
  10 0.24489372247693 0.09471304530702 0.00900887374278 0.00000164273886
*******************************************************************************/
int
main(void)
{
	static int seq[4] = {1, 2, 5, 20};
	int i, j, df1;
	
	puts("lower");
	for (i = 0; i < 4; i++) {
		df1 = seq[i];
		printf("***** p_f(f, %d, df2) *****\n", df1);
		printf("  F   %-16s %-16s %-16s %-16s\n",
		        "df2=1", "df2=2", "df2=5", "df2=20");
		for (j = 0; j <= 10; j++)
			printf("%4d %16.14f %16.14f %16.14f %16.14f\n",
			    j, fcdf(j, df1, 1), fcdf(j, df1, 2),
			       fcdf(j, df1, 5), fcdf(j, df1, 20));
	}
	puts("upper");
	for (i = 0; i < 4; i++) {
		df1 = seq[i];
		printf("***** q_f(f, %d, df2) *****\n", df1);
		printf("  F   %-16s %-16s %-16s %-16s\n",
		        "df2=1", "df2=2", "df2=5", "df2=20");
		for (j = 0; j <= 10; j++)
			printf("%4d %16.14f %16.14f %16.14f %16.14f\n",
			    j, fcdfc(j, df1, 1), fcdfc(j, df1, 2),
			       fcdfc(j, df1, 5), fcdfc(j, df1, 20));
	}
	return 0;
}
